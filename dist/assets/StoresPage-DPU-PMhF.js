import{s as S,j as a,B as u,G as T,L as q,S as A}from"./ui-components-CL-10tNC.js";import{u as G,r}from"./react-vendor-NfsKhbMh.js";import{B as R}from"./BottomNavigation-BMDl6fTq.js";import{M as z}from"./MainHeader-Bm5d1zUE.js";import"./supabase-DQ7Oc2S5.js";import"./stores-BBDuH2RS.js";import"./index-DNL726t5.js";const I=()=>{const h=G(),[g,C]=r.useState([]),[L,p]=r.useState(!0),[o,b]=r.useState(""),[c,_]=r.useState(""),[l,f]=r.useState(""),[i,j]=r.useState(""),[n,v]=r.useState("grid"),[d,M]=r.useState([]),[B,E]=r.useState([]);r.useEffect(()=>{const e=setTimeout(()=>{_(o)},300);return()=>clearTimeout(e)},[o]);const y=r.useCallback(async()=>{try{const{data:e,error:s}=await S.from("store_categories").select("*").eq("is_active",!0).order("name");if(s)throw s;M(e||[])}catch(e){console.error("Error fetching store categories:",e)}},[]),N=r.useCallback(async()=>{try{p(!0);const{data:e,error:s}=await S.from("stores").select("*").eq("is_active",!0).eq("approval_status","approved").order("display_order",{ascending:!0,nullsLast:!0}).order("name");if(s)throw s;if(C(e||[]),e&&e.length>0){const t=Array.from(new Set(e.map(x=>x.location))).filter(Boolean).sort();E(t)}}catch(e){console.error("Error fetching stores:",e)}finally{p(!1)}},[]);r.useEffect(()=>{N(),y()},[N,y]);const k=r.useCallback(e=>{h(`/${e}`)},[h]),m=r.useMemo(()=>g.filter(e=>{var w;const s=e.name.toLowerCase().includes(c.toLowerCase())||((w=e.description)==null?void 0:w.toLowerCase().includes(c.toLowerCase())),t=!l||e.category===l,x=!i||e.location===i;return s&&t&&x}),[g,c,l,i]);return a.jsxs("div",{className:"min-h-screen bg-gray-50 pb-20 dark:bg-gray-900",children:[a.jsx(z,{onSearch:b,searchValue:o}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("h1",{className:"text-2xl font-bold text-gray-900 dark:text-white mb-4",children:"Stores"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-4",children:[a.jsxs("select",{value:l,onChange:e=>f(e.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white py-2 pl-3 pr-10 text-base focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Categories"}),d.map(e=>a.jsx("option",{value:e.id,children:e.name},e.id))]}),a.jsxs("select",{value:i,onChange:e=>j(e.target.value),className:"rounded-md border-gray-300 dark:border-gray-600 dark:bg-gray-800 dark:text-white py-2 pl-3 pr-10 text-base focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[a.jsx("option",{value:"",children:"All Locations"}),B.map(e=>a.jsx("option",{value:e,children:e},e))]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-auto",children:[a.jsx(u,{variant:n==="grid"?"primary":"secondary",onClick:()=>v("grid"),"aria-label":"Grid view",children:a.jsx(T,{className:"h-4 w-4"})}),a.jsx(u,{variant:n==="list"?"primary":"secondary",onClick:()=>v("list"),"aria-label":"List view",children:a.jsx(q,{className:"h-4 w-4"})})]})]})]}),L?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):m.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(A,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500 text-lg dark:text-gray-400",children:"No stores found"}),a.jsx(u,{variant:"link",onClick:()=>{b(""),f(""),j("")},className:"mt-2",children:"Clear filters"})]}):n==="grid"?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:m.map(e=>{const s=d.find(t=>t.id===e.category);return a.jsxs("div",{onClick:()=>k(e.username),className:"bg-white dark:bg-gray-800 rounded-lg shadow-md overflow-hidden transition-all duration-300 hover:shadow-lg hover:-translate-y-1 cursor-pointer",children:[a.jsx("div",{className:"relative h-32 bg-gradient-to-br from-blue-100 to-purple-100 dark:from-blue-900 dark:to-purple-900",children:e.logo_url?a.jsx("img",{src:e.logo_url,alt:e.name,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center",children:a.jsx("span",{className:"text-2xl font-bold text-blue-600 dark:text-blue-300",children:e.name.substring(0,2).toUpperCase()})})}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-white mb-1",children:e.name}),a.jsx("p",{className:"text-xs text-gray-600 dark:text-gray-300 mb-2 line-clamp-2",children:e.description}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"px-2 py-0.5 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-medium rounded-full",children:(s==null?void 0:s.name)||e.category}),a.jsxs("span",{className:"text-xs text-gray-500 dark:text-gray-400 flex items-center",children:[a.jsx("svg",{className:"w-3 h-3 mr-1",fill:"currentColor",viewBox:"0 0 20 20",children:a.jsx("path",{fillRule:"evenodd",d:"M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z",clipRule:"evenodd"})}),e.location]})]})]})]},e.id)})}):a.jsx("div",{className:"bg-white dark:bg-gray-800 shadow-md rounded-lg overflow-hidden",children:a.jsx("ul",{className:"divide-y divide-gray-200 dark:divide-gray-700",children:m.map(e=>{const s=d.find(t=>t.id===e.category);return a.jsx("li",{onClick:()=>k(e.username),className:"cursor-pointer hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors",children:a.jsxs("div",{className:"px-6 py-4 flex items-center",children:[a.jsx("div",{className:"flex-shrink-0 h-16 w-16",children:e.logo_url?a.jsx("img",{src:e.logo_url,alt:e.name,className:"h-16 w-16 rounded-full object-cover"}):a.jsx("div",{className:"h-16 w-16 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center",children:a.jsx("span",{className:"text-xl font-bold text-blue-600 dark:text-blue-300",children:e.name.substring(0,2).toUpperCase()})})}),a.jsxs("div",{className:"ml-4 flex-1",children:[a.jsx("h3",{className:"text-lg font-medium text-gray-900 dark:text-white",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-300 line-clamp-1",children:e.description})]}),a.jsxs("div",{className:"ml-4 flex flex-col items-end",children:[a.jsx("span",{className:"px-2 py-1 bg-blue-100 dark:bg-blue-900 text-blue-800 dark:text-blue-200 text-xs font-medium rounded",children:(s==null?void 0:s.name)||e.category}),a.jsx("span",{className:"mt-1 text-sm text-gray-500 dark:text-gray-400",children:e.location})]})]})},e.id)})})})]}),a.jsx(R,{})]})};export{I as default};
