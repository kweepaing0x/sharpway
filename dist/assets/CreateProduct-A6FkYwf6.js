import{s as b,j as e,B as u,A as q,u as P,x as w,y as E,v as I,D as m,a5 as B,a6 as L}from"./ui-components-CL-10tNC.js";import{u as D,j as F,r as s}from"./react-vendor-NfsKhbMh.js";import"./supabase-DQ7Oc2S5.js";const T=["Clothing","Electronics","Food & Beverages","Home & Living","Health & Beauty","Sports & Leisure","Books & Stationery","Services","Other"],R=()=>{const l=D(),{store:d,storeId:g}=F(),[j,p]=s.useState(!1),[x,i]=s.useState(null),[h,v]=s.useState([]),[C,f]=s.useState(!1),[t,y]=s.useState({store_id:g,name:"",description:"",price:"",image_url:"",category:"",stock_quantity:"0"});s.useEffect(()=>{N()},[]);const N=async()=>{f(!0);try{const{data:r,error:a}=await b.from("product_categories").select("*").eq("is_active",!0).order("name");if(a)throw a;v(r||[])}catch(r){console.error("Error fetching product categories:",r)}finally{f(!1)}},o=r=>{const{name:a,value:n}=r.target;y(c=>({...c,[a]:n}))},k=r=>{y(a=>({...a,image_url:r}))},S=()=>t.name.trim()?t.category?!t.price||parseFloat(t.price)<0?"Please enter a valid price":parseInt(t.stock_quantity)<0?"Stock quantity cannot be negative":null:"Category is required":"Product name is required",_=async r=>{r.preventDefault();const a=S();if(a){i(a);return}p(!0),i(null);try{const{data:n,error:c}=await b.from("products").insert([{...t,store_id:g,price:parseFloat(t.price),stock_quantity:parseInt(t.stock_quantity),in_stock:parseInt(t.stock_quantity)>0}]).select().single();if(c)throw c;l("/store-manager/products")}catch(n){console.error("Error creating product:",n),i(n.message)}finally{p(!1)}};return e.jsxs("div",{className:"max-w-2xl mx-auto py-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(u,{variant:"ghost",onClick:()=>l("/store-manager/products"),className:"mb-4",children:[e.jsx(q,{className:"h-4 w-4 mr-2"}),"Back to Products"]}),e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Create New Product"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Add a new product to your store"})]}),e.jsx(P,{children:e.jsxs("form",{onSubmit:_,children:[e.jsx(w,{children:e.jsx(E,{children:"Product Information"})}),e.jsxs(I,{className:"space-y-4",children:[x&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded relative",children:x}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 text-green-800",children:e.jsxs("p",{className:"font-medium",children:["Store: ",d==null?void 0:d.name]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx(m,{label:"Product Name",name:"name",value:t.name,onChange:o,required:!0,fullWidth:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{name:"category",value:t.category,onChange:o,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-green-500 focus:border-green-500 sm:text-sm rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select a category"}),C?e.jsx("option",{value:"",disabled:!0,children:"Loading categories..."}):h.length>0?h.map(r=>e.jsx("option",{value:r.id,children:r.name},r.id)):T.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",value:t.description,onChange:o,rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Product Image"}),e.jsx(B,{value:t.image_url,onChange:k,onError:i,bucket:"products",folder:"products"})]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:[e.jsx(m,{label:"Price (THB)",name:"price",type:"number",min:"0",step:"0.01",value:t.price,onChange:o,required:!0,fullWidth:!0,helperText:"Enter price in Thai Baht"}),e.jsx(m,{label:"Stock Quantity",name:"stock_quantity",type:"number",min:"0",value:t.stock_quantity,onChange:o,required:!0,fullWidth:!0})]})]}),e.jsxs(L,{className:"flex justify-end space-x-2",children:[e.jsx(u,{type:"button",variant:"secondary",onClick:()=>l("/store-manager/products"),children:"Cancel"}),e.jsx(u,{type:"submit",variant:"primary",isLoading:j,className:"bg-green-600 hover:bg-green-700",children:"Create Product"})]})]})})]})};export{R as default};
