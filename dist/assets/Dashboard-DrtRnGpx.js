import{s as j,j as e,u as n,v as d,o as g,k as S,$ as k,x as y,y as f}from"./ui-components-CL-10tNC.js";import{j as C,r as m}from"./react-vendor-NfsKhbMh.js";import{i as T,f as x}from"./stores-BBDuH2RS.js";import"./supabase-DQ7Oc2S5.js";const E=()=>{const{store:q,storeId:c}=C(),[o,N]=m.useState({productCount:0,orders:{total:0,pending:0,completed:0},topProducts:[]}),[l,b]=m.useState([]),[w,h]=m.useState(!0);m.useEffect(()=>{c&&(_(),v())},[c]);const _=async()=>{h(!0);try{const{data:s,error:t}=await j.from("products").select("id").eq("store_id",c);if(t)throw t;N({productCount:(s==null?void 0:s.length)||0,orders:{total:24,pending:3,completed:21},topProducts:[{name:"Premium T-Shirt",quantity:45},{name:"Slim Fit Jeans",quantity:32},{name:"Winter Jacket",quantity:28},{name:"Running Shoes",quantity:25}]})}catch(s){console.error("Error fetching stats:",s)}finally{h(!1)}},v=async()=>{try{const{data:s,error:t}=await j.from("store_hours").select("*").eq("store_id",c).order("day_of_week");if(t)throw t;const r=(s==null?void 0:s.map(a=>{var u,p;return{...a,opens_at:(u=a.opens_at)==null?void 0:u.slice(0,5),closes_at:(p=a.closes_at)==null?void 0:p.slice(0,5)}}))||[];b(r)}catch(s){console.error("Error fetching working hours:",s)}};if(w)return e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-500",children:"Loading dashboard data..."})]});const i=T(l);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Dashboard"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Welcome to your store management dashboard"})]}),e.jsx(n,{className:`${i?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsx(d,{className:"p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:`h-6 w-6 ${i?"text-green-600":"text-red-600"} mr-3`}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium",children:["Store Status: ",e.jsx("span",{className:i?"text-green-700":"text-red-700",children:i?"Open":"Closed"})]}),l.length>0&&!i&&e.jsxs("p",{className:"text-sm mt-1",children:["Next opening: ",(()=>{const s=new Date,t=s.getDay();let r=l.find(a=>(a.day_of_week>t||a.day_of_week===t&&a.closes_at>s.toTimeString().slice(0,5))&&!a.is_closed);return r||(r=l.find(a=>!a.is_closed)),r?`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][r.day_of_week]} ${x(r.opens_at)}`:"Not available"})()]})]})]})})}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[e.jsx(n,{children:e.jsxs(d,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Total Products"}),e.jsx("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:o.productCount})]}),e.jsx("div",{className:"bg-green-100 rounded-full p-3",children:e.jsx(S,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx(n,{children:e.jsxs(d,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Pending Orders"}),e.jsx("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:o.orders.pending})]}),e.jsx("div",{className:"bg-yellow-100 rounded-full p-3",children:e.jsx(g,{className:"h-6 w-6 text-yellow-600"})})]})}),e.jsx(n,{children:e.jsxs(d,{className:"p-6 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500 truncate",children:"Monthly Revenue"}),e.jsxs("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:["à¸¿",54750 .toLocaleString()]})]}),e.jsx("div",{className:"bg-purple-100 rounded-full p-3",children:e.jsx(k,{className:"h-6 w-6 text-purple-600"})})]})})]}),e.jsxs(n,{children:[e.jsx(y,{children:e.jsx(f,{children:"Working Hours"})}),e.jsx(d,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map(s=>{const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][s.day_of_week];return e.jsxs("div",{className:"flex justify-between py-2 border-b border-gray-100",children:[e.jsx("span",{className:"font-medium",children:t}),e.jsx("span",{children:s.is_closed?e.jsx("span",{className:"text-red-600",children:"Closed"}):`${x(s.opens_at)} - ${x(s.closes_at)}`})]},s.id)})})})]}),e.jsxs(n,{children:[e.jsx(y,{children:e.jsx(f,{children:"Top Products"})}),e.jsx(d,{children:e.jsx("ul",{className:"space-y-3",children:o.topProducts.map((s,t)=>e.jsxs("li",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"relative w-32 h-2 bg-gray-200 rounded",children:e.jsx("div",{className:"absolute h-2 bg-green-500 rounded",style:{width:`${s.quantity/Math.max(...o.topProducts.map(r=>r.quantity))*100}%`}})}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.quantity," sold"]})]})]},t))})})]})]})};export{E as default};
