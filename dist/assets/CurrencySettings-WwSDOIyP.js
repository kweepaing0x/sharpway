import{j as e,u as _,x as v,y as H,B as T,a8 as K,v as N,D as h}from"./ui-components-CL-10tNC.js";import{r as i}from"./react-vendor-NfsKhbMh.js";import{b as w}from"./stores-BBDuH2RS.js";import"./supabase-DQ7Oc2S5.js";const q=()=>{var j,f,S;const{rates:a,loading:t,error:x,fetchRates:o,updateRates:D}=w(),[n,g]=i.useState({THB_USD:"",THB_MMK:"",USD_MMK:""}),[d,M]=i.useState(!1),[p,c]=i.useState(null),[b,u]=i.useState(null);i.useEffect(()=>{o()},[o]),i.useEffect(()=>{var l,s,r;g({THB_USD:((l=a==null?void 0:a.THB_USD)==null?void 0:l.toString())??"",THB_MMK:((s=a==null?void 0:a.THB_MMK)==null?void 0:s.toString())??"",USD_MMK:((r=a==null?void 0:a.USD_MMK)==null?void 0:r.toString())??""})},[a]);const m=l=>{const{name:s,value:r}=l.target;g(U=>({...U,[s]:r})),u(null),c(null)},y=async l=>{l.preventDefault(),M(!0),u(null),c(null);try{const s={THB_USD:parseFloat(n.THB_USD),THB_MMK:parseFloat(n.THB_MMK),USD_MMK:parseFloat(n.USD_MMK)};if(Object.values(s).some(r=>isNaN(r)))throw new Error("Please enter valid numbers for all exchange rates");if(Object.values(s).some(r=>r<=0))throw new Error("Exchange rates must be greater than 0");if(s.THB_USD>1||s.THB_USD<.001)throw new Error("THB to USD rate seems unrealistic (should be between 0.001 and 1)");if(s.THB_MMK>1e4||s.THB_MMK<1)throw new Error("THB to MMK rate seems unrealistic (should be between 1 and 10,000)");if(s.USD_MMK>1e5||s.USD_MMK<100)throw new Error("USD to MMK rate seems unrealistic (should be between 100 and 100,000)");await D(s),c("Exchange rates updated successfully!"),setTimeout(()=>c(null),5e3)}catch(s){u(s.message)}finally{M(!1)}},B=async()=>{await o()};return e.jsxs(_,{children:[e.jsx(v,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(H,{children:"Currency Exchange Rates"}),e.jsxs(T,{variant:"secondary",onClick:B,disabled:t,className:"flex items-center space-x-2",children:[e.jsx(K,{className:`h-4 w-4 ${t?"animate-spin":""}`}),e.jsx("span",{children:"Refresh"})]})]})}),e.jsxs(N,{children:[t&&!d&&e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading exchange rates..."})]}),e.jsxs("form",{onSubmit:y,className:"space-y-4",children:[x&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700 rounded-md",children:[e.jsx("strong",{children:"Database Error:"})," ",x]}),b&&e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 text-red-700 rounded-md",children:[e.jsx("strong",{children:"Validation Error:"})," ",b]}),p&&e.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 text-green-700 rounded-md",children:[e.jsx("strong",{children:"Success:"})," ",p]}),e.jsxs("div",{className:"grid grid-cols-1 gap-4 sm:grid-cols-3",children:[e.jsx(h,{label:"THB to USD Rate",name:"THB_USD",type:"number",step:"0.0001",min:"0",value:n.THB_USD,onChange:m,helperText:"1 THB = ? USD (e.g., 0.028)",required:!0,fullWidth:!0,disabled:t}),e.jsx(h,{label:"THB to MMK Rate",name:"THB_MMK",type:"number",step:"0.01",min:"0",value:n.THB_MMK,onChange:m,helperText:"1 THB = ? MMK (e.g., 136)",required:!0,fullWidth:!0,disabled:t}),e.jsx(h,{label:"USD to MMK Rate",name:"USD_MMK",type:"number",step:"0.01",min:"0",value:n.USD_MMK,onChange:m,helperText:"1 USD = ? MMK (e.g., 3300)",required:!0,fullWidth:!0,disabled:t})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Current Exchange Rates"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"1 THB ="}),e.jsxs("span",{className:"font-medium",children:["$",((j=a.THB_USD)==null?void 0:j.toFixed(4))||"0.0000"," USD"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"1 THB ="}),e.jsxs("span",{className:"font-medium",children:[((f=a.THB_MMK)==null?void 0:f.toFixed(2))||"0.00"," MMK"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"1 USD ="}),e.jsxs("span",{className:"font-medium",children:[((S=a.USD_MMK)==null?void 0:S.toFixed(2))||"0.00"," MMK"]})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(T,{type:"submit",variant:"primary",isLoading:d,disabled:t||d,children:d?"Updating Exchange Rates...":"Update Exchange Rates"})})]}),e.jsx("div",{className:"mt-4 text-xs text-gray-500",children:e.jsxs("p",{children:[e.jsx("strong",{children:"Note:"})," Exchange rates are now stored in the database and will be available across all sessions. These rates are used throughout the application for currency conversions."]})})]})]})};export{q as default};
