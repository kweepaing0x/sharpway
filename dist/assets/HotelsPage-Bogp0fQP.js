import{j as e,s as D,S as R,X as S,c as L,B as $,e as H,M as O,f as M}from"./ui-components-CL-10tNC.js";import{r,u as T}from"./react-vendor-NfsKhbMh.js";import{B as q}from"./BottomNavigation-BMDl6fTq.js";import{F as z,S as P,a as V}from"./FilterDrawer-D0ALiK1_.js";import"./supabase-DQ7Oc2S5.js";import"./index-DNL726t5.js";function X({variant:a="default",className:t=""}){return a==="taxi"?e.jsx("div",{className:`
          bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A]
          border border-[#2A2A2A] rounded-2xl p-4
          animate-pulse ${t}
        `,children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsxs("div",{className:"flex-1 space-y-3",children:[e.jsx("div",{className:"h-5 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-3/4 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-4 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-1/2 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"h-6 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-full w-20 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-6 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-full w-16 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})})]})]})]})}):a==="hotel"?e.jsxs("div",{className:`
          bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A]
          border border-[#2A2A2A] rounded-2xl overflow-hidden
          animate-pulse ${t}
        `,children:[e.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("div",{className:"h-6 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-3/4 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-4 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-full relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-4 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-2/3 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsxs("div",{className:"flex justify-between items-center pt-2",children:[e.jsx("div",{className:"h-5 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-24 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-8 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-full w-20 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})})]})]})]}):e.jsx("div",{className:`
        bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A]
        border border-[#2A2A2A] rounded-2xl p-4
        animate-pulse ${t}
      `,children:e.jsxs("div",{className:"space-y-3",children:[e.jsx("div",{className:"h-5 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-3/4 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-4 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-full relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),e.jsx("div",{className:"h-4 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A] rounded-lg w-5/6 relative overflow-hidden",children:e.jsx("div",{className:"absolute inset-0 shimmer"})})]})})}function Y({icon:a,title:t,description:o,action:l,illustration:n,className:i=""}){return e.jsxs("div",{className:`
        flex flex-col items-center justify-center
        py-16 px-6 text-center
        ${i}
      `,children:[n&&e.jsx("div",{className:"mb-6 w-full max-w-xs opacity-60",children:n}),a&&e.jsx("div",{className:"mb-4 p-4 rounded-2xl bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A] border border-[#2A2A2A]",children:a}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:t}),o&&e.jsx("p",{className:"text-gray-400 text-sm max-w-md mb-6",children:o}),l&&e.jsx("div",{className:"mt-4",children:l})]})}function J({children:a,onRefresh:t}){return e.jsx("div",{className:"relative h-full overflow-auto",children:a})}function K({src:a,alt:t,className:o="",placeholderClassName:l="",onLoad:n,onError:i,threshold:m=300}){const[A,f]=r.useState(!0),[x,j]=r.useState(!1),[p,b]=r.useState(!1),c=r.useRef(null);r.useEffect(()=>{const g=c.current;if(!g)return;const u=new IntersectionObserver(v=>{const[d]=v;d.isIntersecting&&(j(!0),u.disconnect())},{root:null,rootMargin:`${m}px`,threshold:0});return u.observe(g),()=>{u.disconnect()}},[m]);const y=()=>{f(!1),n==null||n()},N=()=>{f(!1),b(!0),i==null||i()};return e.jsxs("div",{className:`relative overflow-hidden ${o}`,children:[A&&!p&&e.jsx("div",{className:`
            absolute inset-0 bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A]
            ${l}
          `,children:e.jsx("div",{className:"absolute inset-0 shimmer"})}),p?e.jsx("div",{className:`
            absolute inset-0 flex items-center justify-center
            bg-gradient-to-br from-[#2A2A2A] to-[#1A1A1A]
            text-gray-500
            ${l}
          `,children:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}):e.jsx("img",{ref:c,src:x?a:void 0,alt:t,className:`
            w-full h-full object-cover
            transition-opacity duration-500
            ${A?"opacity-0":"opacity-100"}
          `,onLoad:y,onError:N,loading:"lazy"})]})}function Q({searchFunction:a,searchQuery:t,filters:o={},limit:l=20,offset:n=0,debounceMs:i=500,enabled:m=!0}){const[A,f]=r.useState(t),x=r.useRef(null);r.useEffect(()=>{const d=setTimeout(()=>{f(t)},i);return()=>{clearTimeout(d)}},[t,i]);const[j,p]=r.useState(void 0),[b,c]=r.useState(!1),[y,N]=r.useState(!1),[g,u]=r.useState(null),v=r.useCallback(async()=>{if(m)try{c(!0),N(!1),u(null),x.current&&x.current.abort(),x.current=new AbortController;const d={search_query:A||"",limit_count:l,offset_count:n};a==="search_taxis"?(d.vehicle_type_filter=o.vehicle_type||"",d.location_filter=o.location||""):a==="search_hotels"&&(d.location_filter=o.location||"",d.category_filter=o.category||"");const{data:C,error:w}=await D.rpc(a,d);if(w)throw new Error(w.message);p(C)}catch(d){d.name!=="AbortError"&&(N(!0),u(d))}finally{c(!1)}},[a,A,o,l,n,m]);return r.useEffect(()=>{v()},[v]),r.useEffect(()=>()=>{x.current&&x.current.abort()},[]),{data:j,isLoading:b,isError:y,error:g,refetch:v}}const _="search_history_",E=10;function k(a){try{const t=`${_}${a}`,o=localStorage.getItem(t);return o?JSON.parse(o).sort((n,i)=>i.timestamp-n.timestamp).slice(0,E):[]}catch(t){return console.error("Error loading search history:",t),[]}}function U(a,t){if(t.trim())try{const o=`${_}${a}`,l=k(a),n=l.findIndex(m=>m.query.toLowerCase()===t.toLowerCase());n!==-1&&l.splice(n,1);const i=[{query:t.trim(),timestamp:Date.now()},...l].slice(0,E);localStorage.setItem(o,JSON.stringify(i))}catch(o){console.error("Error saving search history:",o)}}function W(a){try{const t=`${_}${a}`;localStorage.removeItem(t)}catch(t){console.error("Error clearing search history:",t)}}const ae=()=>{const a=T(),[t,o]=r.useState(""),[l,n]=r.useState(""),[i,m]=r.useState(""),[A,f]=r.useState(!1),[x,j]=r.useState(!1),[p,b]=r.useState([]);r.useEffect(()=>{const s=k("hotels");b(s.map(h=>h.query))},[]);const{data:c,isLoading:y,refetch:N}=Q({searchFunction:"search_hotels",searchQuery:t,filters:{location:l,category:i},limit:50,offset:0,debounceMs:500}),g=r.useMemo(()=>c||[],[c]),u=r.useMemo(()=>{let s=0;return l&&s++,i&&s++,s},[l,i]),v=r.useMemo(()=>c?Array.from(new Set(c.map(h=>h.location))).filter(Boolean).sort():[],[c]),d=r.useMemo(()=>c?Array.from(new Set(c.map(h=>h.category))).filter(Boolean).sort():[],[c]),C=r.useCallback(s=>{a(`/hotel/${s}`)},[a]),w=r.useCallback(s=>{if(o(s),s.trim()){U("hotels",s);const h=k("hotels");b(h.map(F=>F.query))}},[]),B=()=>{n(""),m("")},I=async()=>{await N()};return e.jsxs("div",{className:"min-h-screen bg-[#0A0A0A] pb-20",children:[e.jsx("div",{className:"sticky top-0 z-40 bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A] border-b border-[#2A2A2A] shadow-lg backdrop-blur-xl",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h1",{className:"text-2xl font-bold text-white",children:"Hotels"}),e.jsx("button",{onClick:()=>f(!0),className:"p-2.5 hover:bg-[#2A2A2A] rounded-full transition-colors","aria-label":"Search hotels",children:e.jsx(R,{className:"w-5 h-5 text-gray-300"})})]}),t&&e.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Searching for:"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#00D9FF]/10 border border-[#00D9FF]/30 rounded-full",children:[e.jsx("span",{className:"text-sm font-medium text-[#00D9FF]",children:t}),e.jsx("button",{onClick:()=>o(""),className:"p-0.5 hover:bg-[#00D9FF]/20 rounded-full transition-colors",children:e.jsx(S,{className:"w-3.5 h-3.5 text-[#00D9FF]"})})]})]}),u>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-2",children:[l&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#8B5CF6]/10 border border-[#8B5CF6]/30 rounded-full",children:[e.jsx("span",{className:"text-sm font-medium text-[#8B5CF6]",children:l}),e.jsx("button",{onClick:()=>n(""),className:"p-0.5 hover:bg-[#8B5CF6]/20 rounded-full transition-colors",children:e.jsx(S,{className:"w-3.5 h-3.5 text-[#8B5CF6]"})})]}),i&&e.jsxs("div",{className:"flex items-center gap-2 px-3 py-1.5 bg-[#8B5CF6]/10 border border-[#8B5CF6]/30 rounded-full",children:[e.jsx("span",{className:"text-sm font-medium text-[#8B5CF6]",children:i}),e.jsx("button",{onClick:()=>m(""),className:"p-0.5 hover:bg-[#8B5CF6]/20 rounded-full transition-colors",children:e.jsx(S,{className:"w-3.5 h-3.5 text-[#8B5CF6]"})})]})]})]})}),e.jsx(J,{onRefresh:I,children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 py-6",children:y?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:Array.from({length:6}).map((s,h)=>e.jsx(X,{variant:"hotel"},h))}):g.length===0?e.jsx(Y,{icon:e.jsx(L,{className:"w-12 h-12 text-[#00D9FF]"}),title:"No hotels found",description:t||u>0?"Try adjusting your search or filters to find available hotels.":"There are no hotels available at the moment. Please check back later.",action:(t||u>0)&&e.jsx($,{variant:"secondary",onClick:()=>{o(""),B()},className:"bg-[#00D9FF] hover:bg-[#00D9FF]/90 text-black btn-animate",children:"Clear all filters"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:g.map(s=>e.jsxs("div",{onClick:()=>C(s.username),className:"bg-gradient-to-br from-[#1A1A1A] to-[#0A0A0A] rounded-2xl border border-[#2A2A2A] overflow-hidden cursor-pointer card-hover",children:[e.jsxs("div",{className:"relative h-48 w-full",children:[s.logo_url?e.jsx(K,{src:s.logo_url,alt:s.name,className:"w-full h-full"}):e.jsx("div",{className:"w-full h-full bg-gradient-to-br from-[#FF6B35]/20 to-[#00D9FF]/20 flex items-center justify-center",children:e.jsx("span",{className:"text-4xl font-bold text-[#00D9FF]",children:s.name.substring(0,2).toUpperCase()})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"})]}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsx("h3",{className:"text-lg font-semibold text-white line-clamp-1",children:s.name}),s.description&&e.jsx("p",{className:"text-sm text-gray-400 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.star_rating&&s.star_rating>0&&e.jsx("div",{className:"flex items-center gap-1",children:Array.from({length:s.star_rating}).map((h,F)=>e.jsx(H,{className:"w-4 h-4 fill-[#FACC15] text-[#FACC15]"},F))}),s.category&&e.jsx("span",{className:"px-2.5 py-1 bg-[#8B5CF6]/20 border border-[#8B5CF6]/30 text-[#8B5CF6] text-xs font-medium rounded-full",children:s.category})]}),e.jsxs("div",{className:"flex items-center justify-between pt-2 border-t border-[#2A2A2A]",children:[e.jsxs("div",{className:"flex items-center text-sm text-gray-400",children:[e.jsx(O,{className:"w-4 h-4 mr-1"}),s.location]}),e.jsx("button",{className:"px-4 py-2 bg-[#00D9FF] hover:bg-[#00D9FF]/90 text-black text-sm font-medium rounded-xl btn-animate",children:"View Details"})]})]})]},s.id))})})}),e.jsx(z,{icon:e.jsx(M,{className:"w-6 h-6"}),onClick:()=>j(!0),label:"Filters",color:"purple",badge:u}),e.jsx(P,{isOpen:A,onClose:()=>f(!1),searchValue:t,onSearchChange:w,placeholder:"Search hotels by name or location...",recentSearches:p,onRecentSearchClick:s=>{o(s),f(!1)},onClearRecent:()=>{W("hotels"),b([])}}),e.jsx(V,{isOpen:x,onClose:()=>j(!1),onApply:()=>{},onReset:B,title:"Filter Hotels",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-3",children:"Location"}),e.jsxs("select",{value:l,onChange:s=>n(s.target.value),className:"w-full px-4 py-3 bg-[#2A2A2A] border border-[#3A3A3A] rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-[#8B5CF6] focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Locations"}),v.map(s=>e.jsx("option",{value:s,children:s},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-semibold text-white mb-3",children:"Category"}),e.jsxs("select",{value:i,onChange:s=>m(s.target.value),className:"w-full px-4 py-3 bg-[#2A2A2A] border border-[#3A3A3A] rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-[#8B5CF6] focus:border-transparent",children:[e.jsx("option",{value:"",children:"All Categories"}),d.map(s=>e.jsx("option",{value:s,children:s},s))]})]})]})}),e.jsx(q,{})]})};export{ae as default};
